[03/15 11:52:33][INFO] train_net.py: 424: Train with config:
[03/15 11:52:33][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 11:52:37][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 11:52:37][INFO] misc.py: 184: Params: 53,115,280
[03/15 11:52:37][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 11:52:37][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 11:52:37][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 11:52:37][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 11:52:37][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 11:52:37][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 11:52:37][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 11:52:37][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 11:52:37][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 11:52:37][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 11:52:37][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 11:52:38][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 11:52:38][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 11:52:38][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 11:52:38][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 11:52:38][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 11:52:38][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 11:52:38][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 11:52:38][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 11:52:38][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 11:52:38][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 11:52:38][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 11:52:38][INFO] misc.py: 196: nvidia-smi
[03/15 11:52:38][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 12:16:44][INFO] train_net.py: 424: Train with config:
[03/15 12:16:44][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 12:16:47][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 12:16:47][INFO] misc.py: 184: Params: 53,115,280
[03/15 12:16:47][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 12:16:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:16:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:16:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:16:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:16:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:16:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:16:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:16:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:16:48][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:16:48][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 12:16:49][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:16:49][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:16:49][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:16:49][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 12:16:49][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:16:49][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:16:49][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:16:49][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:16:49][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:16:49][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:16:49][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 12:16:49][INFO] misc.py: 196: nvidia-smi
[03/15 12:16:49][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 12:17:48][INFO] train_net.py: 424: Train with config:
[03/15 12:17:48][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 12:17:51][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 12:17:51][INFO] misc.py: 184: Params: 53,115,280
[03/15 12:17:51][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 12:17:52][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:17:52][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:17:52][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:17:52][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:17:52][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:17:52][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:17:52][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:17:52][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:17:52][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:17:52][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 12:17:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:17:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:17:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:17:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 12:17:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:17:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:17:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:17:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:17:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:17:53][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:17:53][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 12:17:53][INFO] misc.py: 196: nvidia-smi
[03/15 12:17:53][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 12:42:12][INFO] train_net.py: 424: Train with config:
[03/15 12:42:12][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 12:42:16][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 12:42:16][INFO] misc.py: 184: Params: 53,115,280
[03/15 12:42:16][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 12:42:17][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:42:17][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:42:17][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:42:17][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:42:17][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:42:17][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:42:17][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:42:17][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:42:17][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:42:17][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 12:42:17][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:42:17][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:42:17][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:42:17][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 12:42:17][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:42:17][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:42:17][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:42:17][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:42:17][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:42:17][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:42:17][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 12:42:17][INFO] misc.py: 196: nvidia-smi
[03/15 12:42:18][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 12:42:43][INFO] train_net.py: 424: Train with config:
[03/15 12:42:43][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 12:42:47][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 12:42:47][INFO] misc.py: 184: Params: 53,115,280
[03/15 12:42:47][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 12:42:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:42:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:42:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:42:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:42:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:42:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:42:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:42:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:42:48][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:42:48][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 12:42:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:42:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:42:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:42:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 12:42:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:42:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:42:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:42:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:42:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:42:48][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:42:48][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 12:42:48][INFO] misc.py: 196: nvidia-smi
[03/15 12:42:49][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 12:42:49][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 12:42:49][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 12:42:49][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 12:42:49][INFO] train_net.py: 468: Start epoch: 1
[03/15 12:42:49][WARNING] kinetics.py: 252: Failed to decode video idx 46 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4; trial 0
[03/15 12:42:49][WARNING] kinetics.py: 252: Failed to decode video idx 46 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4; trial 1
[03/15 12:42:49][WARNING] kinetics.py: 252: Failed to decode video idx 46 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4; trial 2
[03/15 12:42:49][WARNING] kinetics.py: 252: Failed to decode video idx 46 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4; trial 3
[03/15 12:42:49][WARNING] kinetics.py: 252: Failed to decode video idx 46 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4; trial 4
[03/15 12:42:49][WARNING] kinetics.py: 252: Failed to decode video idx 46 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4; trial 5
[03/15 12:42:49][WARNING] kinetics.py: 252: Failed to decode video idx 46 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4; trial 6
[03/15 12:42:49][WARNING] kinetics.py: 252: Failed to decode video idx 99 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/5fmxORDrj1U_000123_000133.mp4; trial 7
[03/15 12:42:49][WARNING] kinetics.py: 252: Failed to decode video idx 26 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/0pP5PNGEDi0_000159_000169.mp4; trial 8
[03/15 12:42:49][WARNING] kinetics.py: 252: Failed to decode video idx 77 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/3YzplIZVXpM_000089_000099.mp4; trial 9
[03/15 12:50:56][INFO] train_net.py: 424: Train with config:
[03/15 12:50:56][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 12:51:00][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 12:51:00][INFO] misc.py: 184: Params: 53,115,280
[03/15 12:51:00][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 12:51:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:51:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:51:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:51:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:51:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:51:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:51:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:51:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:51:01][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:51:01][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 12:51:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:51:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:51:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:51:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 12:51:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:51:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:51:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:51:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:51:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:51:01][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:51:02][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 12:51:02][INFO] misc.py: 196: nvidia-smi
[03/15 12:51:02][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 12:51:02][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 12:51:02][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 12:51:02][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 12:51:02][INFO] train_net.py: 468: Start epoch: 1
[03/15 12:52:22][INFO] train_net.py: 424: Train with config:
[03/15 12:52:22][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 12:52:25][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 12:52:25][INFO] misc.py: 184: Params: 53,115,280
[03/15 12:52:25][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 12:52:26][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:52:26][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:52:26][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:52:26][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:52:26][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:52:26][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:52:26][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:52:26][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:52:26][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:52:26][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 12:52:27][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:52:27][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:52:27][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:52:27][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 12:52:27][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:52:27][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:52:27][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:52:27][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:52:27][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:52:27][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:52:27][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 12:52:27][INFO] misc.py: 196: nvidia-smi
[03/15 12:52:27][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 12:52:27][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 12:52:27][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 12:52:27][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 12:52:27][INFO] train_net.py: 468: Start epoch: 1
[03/15 12:52:40][INFO] kinetics.py: 212: Failed to load video from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4 with error 
[03/15 12:52:40][WARNING] kinetics.py: 212: Failed to meta load video idx 46 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4; trial 0
[03/15 12:52:42][INFO] kinetics.py: 212: Failed to load video from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4 with error 
[03/15 12:52:42][WARNING] kinetics.py: 212: Failed to meta load video idx 46 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4; trial 1
[03/15 12:52:45][INFO] kinetics.py: 212: Failed to load video from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4 with error 
[03/15 12:52:45][WARNING] kinetics.py: 212: Failed to meta load video idx 46 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4; trial 2
[03/15 12:52:48][INFO] kinetics.py: 212: Failed to load video from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4 with error 
[03/15 12:52:48][WARNING] kinetics.py: 212: Failed to meta load video idx 46 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4; trial 3
[03/15 12:52:50][INFO] kinetics.py: 212: Failed to load video from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4 with error 
[03/15 12:52:50][WARNING] kinetics.py: 212: Failed to meta load video idx 46 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4; trial 4
[03/15 12:52:53][INFO] kinetics.py: 212: Failed to load video from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4 with error 
[03/15 12:52:53][WARNING] kinetics.py: 212: Failed to meta load video idx 46 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4; trial 5
[03/15 12:52:57][INFO] kinetics.py: 212: Failed to load video from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4 with error 
[03/15 12:52:57][WARNING] kinetics.py: 212: Failed to meta load video idx 46 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4; trial 6
[03/15 12:53:06][INFO] kinetics.py: 212: Failed to load video from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/2rX-H4RmyZA_000020_000030.mp4 with error 
[03/15 12:53:06][WARNING] kinetics.py: 212: Failed to meta load video idx 56 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/2rX-H4RmyZA_000020_000030.mp4; trial 7
[03/15 12:53:18][INFO] kinetics.py: 212: Failed to load video from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1g7n_PZzkmg_000000_000010.mp4 with error 
[03/15 12:53:18][WARNING] kinetics.py: 212: Failed to meta load video idx 38 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1g7n_PZzkmg_000000_000010.mp4; trial 8
[03/15 12:53:19][INFO] kinetics.py: 212: Failed to load video from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/3fM92AudOyo_000015_000025.mp4 with error 
[03/15 12:53:19][WARNING] kinetics.py: 212: Failed to meta load video idx 65 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/3fM92AudOyo_000015_000025.mp4; trial 9
[03/15 12:55:56][INFO] train_net.py: 424: Train with config:
[03/15 12:55:56][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 12:56:00][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 12:56:00][INFO] misc.py: 184: Params: 53,115,280
[03/15 12:56:00][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 12:56:00][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:56:00][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:56:00][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:56:00][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:56:00][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:56:00][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:56:00][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:56:00][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:56:00][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:56:00][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 12:56:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:56:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:56:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:56:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 12:56:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:56:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:56:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:56:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:56:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:56:01][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:56:01][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 12:56:01][INFO] misc.py: 196: nvidia-smi
[03/15 12:56:01][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 12:56:01][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 12:56:01][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 12:56:01][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 12:56:01][INFO] train_net.py: 468: Start epoch: 1
[03/15 12:57:46][INFO] train_net.py: 424: Train with config:
[03/15 12:57:46][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 12:57:49][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 12:57:49][INFO] misc.py: 184: Params: 53,115,280
[03/15 12:57:49][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 12:57:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:57:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:57:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:57:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:57:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:57:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:57:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:57:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:57:50][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:57:50][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 12:57:51][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:57:51][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:57:51][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:57:51][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 12:57:51][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:57:51][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:57:51][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:57:51][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:57:51][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:57:51][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:57:51][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 12:57:51][INFO] misc.py: 196: nvidia-smi
[03/15 12:57:51][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 12:57:51][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 12:57:51][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 12:57:51][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 12:57:51][INFO] train_net.py: 468: Start epoch: 1
[03/15 12:58:23][INFO] train_net.py: 424: Train with config:
[03/15 12:58:23][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 12:58:27][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 12:58:27][INFO] misc.py: 184: Params: 53,115,280
[03/15 12:58:27][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 12:58:27][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:58:27][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:58:27][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:58:27][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:58:27][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:58:27][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:58:27][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:58:27][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:58:27][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:58:27][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 12:58:28][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:58:28][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:58:28][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:58:28][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 12:58:28][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:58:28][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:58:28][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:58:28][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:58:28][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:58:28][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:58:28][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 12:58:28][INFO] misc.py: 196: nvidia-smi
[03/15 12:58:28][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 12:58:28][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 12:58:28][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 12:58:28][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 12:58:28][INFO] train_net.py: 468: Start epoch: 1
[03/15 12:58:56][INFO] train_net.py: 424: Train with config:
[03/15 12:58:56][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 12:58:59][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 12:58:59][INFO] misc.py: 184: Params: 53,115,280
[03/15 12:58:59][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 12:59:00][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:59:00][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:59:00][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:59:00][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:59:00][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:59:00][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:59:00][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:59:00][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:59:00][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:59:00][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 12:59:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:59:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:59:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:59:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 12:59:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:59:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:59:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:59:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:59:01][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:59:01][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:59:01][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 12:59:01][INFO] misc.py: 196: nvidia-smi
[03/15 12:59:01][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 12:59:01][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 12:59:01][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 12:59:01][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 12:59:01][INFO] train_net.py: 468: Start epoch: 1
[03/15 12:59:29][INFO] train_net.py: 424: Train with config:
[03/15 12:59:29][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 12:59:32][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 12:59:32][INFO] misc.py: 184: Params: 53,115,280
[03/15 12:59:32][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 12:59:33][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:59:33][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:59:33][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:59:33][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:59:33][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:59:33][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:59:33][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:59:33][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:59:33][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:59:33][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 12:59:34][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 12:59:34][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 12:59:34][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 12:59:34][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 12:59:34][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 12:59:34][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 12:59:34][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 12:59:34][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 12:59:34][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 12:59:34][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 12:59:34][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 12:59:34][INFO] misc.py: 196: nvidia-smi
[03/15 12:59:34][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 12:59:34][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 12:59:34][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 12:59:34][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 12:59:34][INFO] train_net.py: 468: Start epoch: 1
[03/15 13:00:23][INFO] train_net.py: 424: Train with config:
[03/15 13:00:23][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 13:00:27][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 13:00:27][INFO] misc.py: 184: Params: 53,115,280
[03/15 13:00:27][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 13:00:28][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:00:28][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:00:28][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:00:28][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:00:28][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:00:28][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:00:28][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:00:28][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:00:28][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:00:28][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 13:00:29][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:00:29][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:00:29][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:00:29][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 13:00:29][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:00:29][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:00:29][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:00:29][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:00:29][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:00:29][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:00:29][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 13:00:29][INFO] misc.py: 196: nvidia-smi
[03/15 13:00:29][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 13:00:29][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 13:00:29][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 13:00:29][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 13:00:29][INFO] train_net.py: 468: Start epoch: 1
[03/15 13:00:57][INFO] train_net.py: 424: Train with config:
[03/15 13:00:57][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 13:01:01][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 13:01:01][INFO] misc.py: 184: Params: 53,115,280
[03/15 13:01:01][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 13:01:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:01:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:01:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:01:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:01:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:01:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:01:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:01:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:01:02][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:01:02][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 13:01:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:01:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:01:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:01:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 13:01:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:01:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:01:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:01:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:01:02][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:01:02][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:01:02][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 13:01:02][INFO] misc.py: 196: nvidia-smi
[03/15 13:01:03][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 13:01:03][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 13:01:03][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 13:01:03][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 13:01:03][INFO] train_net.py: 468: Start epoch: 1
[03/15 13:11:48][INFO] train_net.py: 424: Train with config:
[03/15 13:11:48][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 13:11:52][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 13:11:52][INFO] misc.py: 184: Params: 53,115,280
[03/15 13:11:52][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 13:11:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:11:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:11:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:11:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:11:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:11:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:11:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:11:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:11:53][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:11:53][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 13:11:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:11:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:11:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:11:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 13:11:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:11:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:11:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:11:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:11:53][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:11:53][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:11:53][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 13:11:53][INFO] misc.py: 196: nvidia-smi
[03/15 13:11:54][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 13:11:54][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 13:11:54][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 13:11:54][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 13:11:54][INFO] train_net.py: 468: Start epoch: 1
[03/15 13:12:14][INFO] train_net.py: 424: Train with config:
[03/15 13:12:14][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 13:12:18][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 13:12:18][INFO] misc.py: 184: Params: 53,115,280
[03/15 13:12:18][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 13:12:19][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:12:19][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:12:19][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:12:19][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:12:19][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:12:19][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:12:19][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:12:19][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:12:19][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:12:19][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 13:12:20][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:12:20][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:12:20][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:12:20][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 13:12:20][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:12:20][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:12:20][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:12:20][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:12:20][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:12:20][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:12:20][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 13:12:20][INFO] misc.py: 196: nvidia-smi
[03/15 13:12:20][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 13:12:20][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 13:12:20][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 13:12:20][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 13:12:20][INFO] train_net.py: 468: Start epoch: 1
[03/15 13:14:35][INFO] train_net.py: 424: Train with config:
[03/15 13:14:35][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 13:14:39][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 13:14:39][INFO] misc.py: 184: Params: 53,115,280
[03/15 13:14:39][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 13:14:40][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:14:40][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:14:40][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:14:40][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:14:40][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:14:40][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:14:40][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:14:40][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:14:40][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:14:40][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 13:14:41][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:14:41][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:14:41][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:14:41][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 13:14:41][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:14:41][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:14:41][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:14:41][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:14:41][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:14:41][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:14:41][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 13:14:41][INFO] misc.py: 196: nvidia-smi
[03/15 13:14:41][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 13:14:41][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 13:14:41][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 13:14:41][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 13:14:41][INFO] train_net.py: 468: Start epoch: 1
[03/15 13:15:10][INFO] train_net.py: 424: Train with config:
[03/15 13:15:10][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 13:15:14][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 13:15:14][INFO] misc.py: 184: Params: 53,115,280
[03/15 13:15:14][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 13:15:15][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:15:15][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:15:15][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:15:15][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:15:15][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:15:15][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:15:15][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:15:15][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:15:15][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:15:15][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 13:15:16][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:15:16][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:15:16][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:15:16][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 13:15:16][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:15:16][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:15:16][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:15:16][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:15:16][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:15:16][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:15:16][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 13:15:16][INFO] misc.py: 196: nvidia-smi
[03/15 13:15:16][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 13:15:16][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 13:15:16][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 13:15:16][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 13:15:16][INFO] train_net.py: 468: Start epoch: 1
[03/15 13:16:31][INFO] train_net.py: 424: Train with config:
[03/15 13:16:31][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'pyav',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 13:16:35][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 13:16:35][INFO] misc.py: 184: Params: 53,115,280
[03/15 13:16:35][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 13:16:36][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:16:36][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:16:36][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:16:36][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:16:36][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:16:36][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:16:36][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:16:36][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:16:36][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:16:36][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 13:16:37][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:16:37][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:16:37][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:16:37][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 13:16:37][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:16:37][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:16:37][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:16:37][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:16:37][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:16:37][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:16:37][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 13:16:37][INFO] misc.py: 196: nvidia-smi
[03/15 13:16:37][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 13:16:37][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 13:16:37][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 13:16:37][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 13:16:37][INFO] train_net.py: 468: Start epoch: 1
[03/15 13:17:02][INFO] train_net.py: 424: Train with config:
[03/15 13:17:02][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'pyav',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 13:17:05][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 13:17:06][INFO] misc.py: 184: Params: 53,115,280
[03/15 13:17:06][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 13:17:06][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:17:06][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:17:06][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:17:06][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:17:06][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:17:06][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:17:06][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:17:06][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:17:06][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:17:06][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 13:17:07][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:17:07][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:17:07][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:17:07][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 13:17:07][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:17:07][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:17:07][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:17:07][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:17:07][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:17:07][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:17:07][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 13:17:07][INFO] misc.py: 196: nvidia-smi
[03/15 13:17:07][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 13:17:07][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 13:17:07][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 13:17:07][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 13:17:07][INFO] train_net.py: 468: Start epoch: 1
[03/15 13:20:05][INFO] train_net.py: 424: Train with config:
[03/15 13:20:05][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'pyav',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 13:20:08][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 13:20:08][INFO] misc.py: 184: Params: 53,115,280
[03/15 13:20:08][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 13:20:09][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:20:09][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:20:09][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:20:09][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:20:09][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:20:09][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:20:09][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:20:09][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:20:09][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:20:09][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 13:20:10][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:20:10][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:20:10][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:20:10][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 13:20:10][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:20:10][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:20:10][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:20:10][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:20:10][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:20:10][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:20:10][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 13:20:10][INFO] misc.py: 196: nvidia-smi
[03/15 13:20:10][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 13:20:10][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 13:20:10][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 13:20:10][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 13:20:10][INFO] train_net.py: 468: Start epoch: 1
[03/15 13:20:30][INFO] train_net.py: 424: Train with config:
[03/15 13:20:30][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'pyav',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 13:20:33][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 13:20:33][INFO] misc.py: 184: Params: 53,115,280
[03/15 13:20:33][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 13:20:34][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:20:34][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:20:34][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:20:34][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:20:34][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:20:34][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:20:34][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:20:34][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:20:34][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:20:34][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 13:20:35][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:20:35][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:20:35][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:20:35][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 13:20:35][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:20:35][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:20:35][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:20:35][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:20:35][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:20:35][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:20:35][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 13:20:35][INFO] misc.py: 196: nvidia-smi
[03/15 13:20:35][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 13:20:35][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 13:20:35][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 13:20:35][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 13:20:35][INFO] train_net.py: 468: Start epoch: 1
[03/15 13:20:59][INFO] train_net.py: 424: Train with config:
[03/15 13:20:59][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'pyav',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 13:21:03][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 13:21:03][INFO] misc.py: 184: Params: 53,115,280
[03/15 13:21:03][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 13:21:04][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:21:04][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:21:04][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:21:04][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:21:04][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:21:04][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:21:04][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:21:04][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:21:04][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:21:04][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 13:21:05][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:21:05][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:21:05][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:21:05][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 13:21:05][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:21:05][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:21:05][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:21:05][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:21:05][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:21:05][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:21:05][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 13:21:05][INFO] misc.py: 196: nvidia-smi
[03/15 13:21:05][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 13:21:05][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 13:21:05][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 13:21:05][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 13:21:05][INFO] train_net.py: 468: Start epoch: 1
[03/15 13:24:53][INFO] train_net.py: 424: Train with config:
[03/15 13:24:53][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'pyav',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 13:24:57][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 13:24:57][INFO] misc.py: 184: Params: 53,115,280
[03/15 13:24:57][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 13:24:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:24:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:24:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:24:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:24:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:24:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:24:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:24:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:24:58][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:24:58][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 13:24:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:24:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:24:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:24:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 13:24:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:24:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:24:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:24:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:24:58][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:24:58][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:24:58][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 13:24:58][INFO] misc.py: 196: nvidia-smi
[03/15 13:24:59][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 13:24:59][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 13:24:59][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 13:24:59][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 13:24:59][INFO] train_net.py: 468: Start epoch: 1
[03/15 13:24:59][INFO] kinetics.py: 219: Failed to load video from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4 with error [Errno 2] No such file or directory: '/home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4'
[03/15 13:24:59][WARNING] kinetics.py: 226: Failed to meta load video idx 46 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4; trial 0
[03/15 13:24:59][INFO] kinetics.py: 219: Failed to load video from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4 with error [Errno 2] No such file or directory: '/home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4'
[03/15 13:24:59][WARNING] kinetics.py: 226: Failed to meta load video idx 46 from /home/v-sizheng/Desktop/SlowFast/data/kinetics400//train/1PH-bf4AVyU_000282_000292.mp4; trial 1
[03/15 13:25:42][INFO] train_net.py: 424: Train with config:
[03/15 13:25:42][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'pyav',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 13:25:46][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 13:25:46][INFO] misc.py: 184: Params: 53,115,280
[03/15 13:25:46][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 13:25:47][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:25:47][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:25:47][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:25:47][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:25:47][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:25:47][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:25:47][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:25:47][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:25:47][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:25:47][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 13:25:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:25:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:25:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:25:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 13:25:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:25:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:25:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:25:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:25:48][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:25:48][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:25:48][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 13:25:48][INFO] misc.py: 196: nvidia-smi
[03/15 13:25:48][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 13:25:48][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 13:25:48][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 13:25:48][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 13:25:48][INFO] train_net.py: 468: Start epoch: 1
[03/15 13:27:45][INFO] train_net.py: 424: Train with config:
[03/15 13:27:45][INFO] train_net.py: 425: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.4,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 2,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.25,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'BGR': False,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/mnt/fair-flash3-east/ava_trainval_frames.img/',
         'FRAME_LIST_DIR': '/mnt/vol/gfsai-flash3-east/ai-group/users/haoqifan/ava/frame_list/',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'DATA': {'DECODING_BACKEND': 'pyav',
          'ENSEMBLE_METHOD': 'sum',
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': False,
          'MEAN': [0.45, 0.45, 0.45],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 32,
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '',
          'PATH_TO_DATA_DIR': 'data/kinetics400/',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': True,
          'REVERSE_INPUT_CHANNEL': False,
          'SAMPLING_RATE': 3,
          'STD': [0.225, 0.225, 0.225],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 0,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'LOG_MODEL_INFO': True,
 'LOG_PERIOD': 10,
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': True,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ACT_CHECKPOINT': False,
           'ARCH': 'mvit',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOSS_FUNC': 'soft_cross_entropy',
           'MODEL_NAME': 'MViT',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 400,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 24,
          'DIM_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.3,
          'EMBED_DIM': 96,
          'HEAD_MUL': [[2, 2.0], [5, 2.0], [21, 2.0]],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [1, 3, 3],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': [1, 8, 8],
          'POOL_Q_STRIDE': [[2, 1, 2, 2], [5, 1, 2, 2], [21, 1, 2, 2]],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': True,
          'ZERO_DECAY_POS_CLS': False},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 0.0001,
            'BASE_LR_SCALE_NUM_SHARDS': True,
            'CLIP_GRAD_L2NORM': 1.0,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': True,
            'COSINE_END_LR': 1e-06,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [],
            'LR_POLICY': 'cosine',
            'MAX_EPOCH': 200,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'STEPS': [],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 30.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 1e-06,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': False,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'kinetics',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 10,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': ''},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 1,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': False,
           'CHECKPOINT_FILE_PATH': '',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PERIOD': 10,
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'kinetics',
           'ENABLE': True,
           'EVAL_PERIOD': 10,
           'MIXED_PRECISION': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[03/15 13:27:48][INFO] misc.py: 183: Model:
MViT(
  (patch_embed): PatchEmbed(
    (proj): Conv3d(3, 96, kernel_size=(3, 7, 7), stride=(2, 4, 4), padding=(1, 3, 3))
  )
  (blocks): ModuleList(
    (0): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=96, bias=True)
      )
    )
    (1): MultiScaleBlock(
      (norm1): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=96, out_features=96, bias=True)
        (k): Linear(in_features=96, out_features=96, bias=True)
        (v): Linear(in_features=96, out_features=96, bias=True)
        (proj): Linear(in_features=96, out_features=96, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 9, 9), stride=(1, 8, 8), padding=(0, 4, 4), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((96,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=96, out_features=384, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=384, out_features=192, bias=True)
      )
      (proj): Linear(in_features=96, out_features=192, bias=True)
    )
    (2): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (3): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=192, bias=True)
      )
    )
    (4): MultiScaleBlock(
      (norm1): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=192, out_features=192, bias=True)
        (k): Linear(in_features=192, out_features=192, bias=True)
        (v): Linear(in_features=192, out_features=192, bias=True)
        (proj): Linear(in_features=192, out_features=192, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 5, 5), stride=(1, 4, 4), padding=(0, 2, 2), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=192, out_features=768, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=768, out_features=384, bias=True)
      )
      (proj): Linear(in_features=192, out_features=384, bias=True)
    )
    (5): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (6): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (7): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (8): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (9): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (10): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (11): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (12): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (13): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (14): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (15): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (16): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (17): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (18): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (19): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=384, bias=True)
      )
    )
    (20): MultiScaleBlock(
      (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=384, out_features=384, bias=True)
        (k): Linear(in_features=384, out_features=384, bias=True)
        (v): Linear(in_features=384, out_features=384, bias=True)
        (proj): Linear(in_features=384, out_features=384, bias=True)
        (pool_k): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_k): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
        (pool_v): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_v): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=384, out_features=1536, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=1536, out_features=768, bias=True)
      )
      (proj): Linear(in_features=384, out_features=768, bias=True)
    )
    (21): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (pool_q): Conv3d(96, 96, kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1), groups=96, bias=False)
        (norm_q): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
      (pool_skip): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
    (22): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
    (23): MultiScaleBlock(
      (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (attn): MultiScaleAttention(
        (q): Linear(in_features=768, out_features=768, bias=True)
        (k): Linear(in_features=768, out_features=768, bias=True)
        (v): Linear(in_features=768, out_features=768, bias=True)
        (proj): Linear(in_features=768, out_features=768, bias=True)
      )
      (drop_path): DropPath()
      (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
      )
    )
  )
  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  (head): TransformerBasicHead(
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=768, out_features=400, bias=True)
    (act): Softmax(dim=1)
  )
)
[03/15 13:27:48][INFO] misc.py: 184: Params: 53,115,280
[03/15 13:27:48][INFO] misc.py: 185: Mem: 0.20124483108520508 MB
[03/15 13:27:49][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:27:49][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:27:49][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:27:49][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:27:49][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:27:49][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:27:49][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:27:49][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:27:49][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:27:49][INFO] misc.py: 186: Flops: 236.31036192 G
[03/15 13:27:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat encountered 1 time(s)
[03/15 13:27:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::repeat_interleave encountered 1 time(s)
[03/15 13:27:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::add encountered 50 time(s)
[03/15 13:27:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::layer_norm encountered 94 time(s)
[03/15 13:27:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::div encountered 72 time(s)
[03/15 13:27:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::mul encountered 168 time(s)
[03/15 13:27:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::softmax encountered 25 time(s)
[03/15 13:27:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::gelu encountered 24 time(s)
[03/15 13:27:50][WARNING] jit_analysis.py: 499: Unsupported operator aten::max_pool3d encountered 3 time(s)
[03/15 13:27:50][WARNING] jit_analysis.py: 511: The following submodules of the model were never called during the trace of the graph. They may be unused, or they were accessed by direct calls to .forward() or via other python methods. In the latter case they will have zeros for statistics, though their statistics will still contribute to their parent calling module.
blocks.1.drop_path, blocks.10.drop_path, blocks.11.drop_path, blocks.12.drop_path, blocks.13.drop_path, blocks.14.drop_path, blocks.15.drop_path, blocks.16.drop_path, blocks.17.drop_path, blocks.18.drop_path, blocks.19.drop_path, blocks.2.drop_path, blocks.20.drop_path, blocks.21.drop_path, blocks.22.drop_path, blocks.23.drop_path, blocks.3.drop_path, blocks.4.drop_path, blocks.5.drop_path, blocks.6.drop_path, blocks.7.drop_path, blocks.8.drop_path, blocks.9.drop_path
[03/15 13:27:50][INFO] misc.py: 191: Activations: 878.778352 M
[03/15 13:27:50][INFO] misc.py: 196: nvidia-smi
[03/15 13:27:50][INFO] kinetics.py:  76: Constructing Kinetics train...
[03/15 13:27:50][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/train.csv
[03/15 13:27:50][INFO] kinetics.py:  76: Constructing Kinetics val...
[03/15 13:27:50][INFO] kinetics.py: 124: Constructing kinetics dataloader (size: 100) from data/kinetics400/val.csv
[03/15 13:27:50][INFO] train_net.py: 468: Start epoch: 1
